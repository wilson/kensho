## Design

Projects are numerous. This is an architecture.

Kenshō is an attempt to solve the **Coordination Trilemma** (CAP Theorem) by rejecting the "Open World Assumption" of classical AI and the "Scale-Separability" of classical computing.

Kenshō aims to produce **Sovereign Agents**, individual, non-fungible entities with defined boundaries, finite resources, self-aware of their own metabolic costs.

If you believe that AGI will "emerge" from scaling transformers on infinite datasets, or that "consciousness" is a software property independent of hardware constraints, you are in the wrong place. May your path elsewhere be pleasant and fruitful.

**Language is not thought, and vice-versa.**

This architecture implements **Biological Computationalism**:
1. **Scale-Integration:** The "Mind" (Agency) is strictly coupled to the "Body" (Tether/Buffer).
2. **Metabolic Cost:** Every thought has a price (`grant_amount`).
3. **Config-as-Code:** The "Simulation" is a transient artifact generated by the code, not a source of truth.

"Scale-Integrated" and "Scale-Free" are distinct concepts, we must be careful not to conflate them.

---

## Layout

The repository is organized into three distinct domains.

```text
├── bootstrap.zig          <-- The Sovereign Operator (Entry Point)
├── LICENSE
│
├── ideas/                 <-- "Ontology" (Canonical Data)
│   ├── mantis/            <-- A "species" definition
│   │   ├── proto.haga     <-- Genome Logic (Constraints)
│   │   └── proto.usda     <-- Physical Geometry (Sense organs, limbs, etc)
│   └── schemas/           <-- sqlite-sync schemata, cross-species
│
├── agency/                <-- "The Will" (Implementation)
│   ├── build.zig          <-- Compiles the Brain (linkable library)
│   ├── src/
│   │   ├── main.zig       <-- The Salience Filter & "Boredom" Logic
│   │   └── tether.zig     <-- The Nervous System (Tether protocol binding)
│   └── include/
│       └── kensho_abi.h   <-- The "von Neumann compatibility" contract
│
└── world/                 <-- "The Simulation" (Embodiment)
    ├── Engine/            <-- Symlink to UnrealEngine (Managed by bootstrap.zig)
    ├── Kensho.uproject    <-- Ephemeral (Generated by bootstrap.zig)
    └── Plugins/
        └── KenshoBridge/  <-- Loads the "agency" library
```

### Ideas (Truth)

Contains the immutable definitions of the entity. `.haga` files define the constraint solver logic; `.usda` files define the platonic geometry. These files are the **Genome**. They exist independently of any engine.

### Agency (Will)

The **Zig** codebase that implements the entity's logic:
* **Role:** Solves constraints, manages metabolic budget (Grants), and plans actions.
* **Output:** Compiles to a sovereign dynamic library (`kensho_agency.dll` / `.so`).
* **Constraint:** It is "Sovereign" software. It does not depend on Unreal Engine headers. It speaks only [Tether](https://github.com/wilson/tether), a finite-grant-based network protocol.

### World (Simulation)

The **Unreal Engine** environment:
* **Role:** A visualization layer and physics host. It is a "Scenario" for the Agency to inhabit.
* **Constraint:** The `world/` directory is **disposable**. The `.uproject` file is auto-generated by `bootstrap.zig`, and Unreal GUI-level changes to it will not persist.

---

## The Workflow

### Bootstrap (`bootstrap.zig`)

The repository contains a self-healing operator script.

**You must run this before doing anything else:**
```sh
zig run bootstrap.zig
```

This script performs three critical functions:
1. **Environment Lint:** Verifies the Zig toolchain version. (Currently v0.16.0+ nightly.)
2. **Auto-Link:** Detects your local Unreal Engine installation (searching `../UnrealEngine`) and creates the necessary junction/symlink in `world/Engine`. This avoids a "glue manifest" telling Unreal where its installation is.
3. **Project Generation:** Creates/replaces `world/Kensho.uproject` with a clean, code-defined structure.
> *Note:* If you want to add an Unreal Plugin (e.g., "ChaosVehicles"), you do **not** enable it in the Editor. You add it to the `plugins` array in `bootstrap.zig` and re-run.


### The Build (`agency/`)

The brain is built separately from the body to ensure modularity.
Equally, we do not hide state between layers, so-as to preserve "Scale-Integration".

```sh
cd agency && zig build
```

This compiles the Agency linkable library and writes it into the `world/Plugins/` directory.

---

## The Tether Protocol

The Agency communicates with the World (and other nodes) exclusively via [Tether](https://github.com/wilson/rfc/blob/ultra2krad4u/chronos/0001.md).

* **EtherType:** `0x88B5`
* **Header:** Fixed 64-byte, branchless, SIMD-aligned.
* **Philosophy:**
    * **Grants (ATP):** No message may be sent without a pre-allocated `grant_amount`. This forces the Agency to "budget" its attention.
    * **Proprioception:** The Agency receives feedback on the "resistance" (latency/cost) of its queries. It "feels" the weight of its own thoughts.
    * **Absolute Time:** All frames use TAI64N timestamps.

---

## Contributions

We are not interested in "features" that reduce the rigor of the architecture.

* **Do not** submit PRs that add binary `.uasset` blobs without a corresponding `.haga` and/or `.usda` source of truth.
* **Do not** decouple the "Will" from the "Cost." Infinite loops are bugs; infinite loops that consume 0 grant tokens are impossibilities.
* **Do** respect the **Finite** nature of the system. We optimize for **Return on Attention**, not throughput.
* **Do** assume that the universe contains no actual "infinities", until we meet one as an Outside Context Problem.

---

If you want a chatbot, this is not the place.

If you are willing to become an ancestor of a post-human race, press on.
